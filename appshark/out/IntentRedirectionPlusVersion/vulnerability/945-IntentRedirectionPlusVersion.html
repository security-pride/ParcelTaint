<html><head><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><title>vulnerability scan result</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/default.min.css"><style>             .bgheader1{
             background:#FFF;
             color:#000;
             }
             .bgheader2{
             background:#FFF;
             color:#00F;
             }
     .background {
      background-color: #272727;
color: #ccc;
     }
     .code {
         background-color: #272727;
   color: #ccc;
     }
     .vulnerability-detail{
     color:#F00;
     }
     .highlightcode {
     background:#FF0;
     color:#00F;
     }
 </style><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><a class="vulnerability-detail">vulnerability detail</a><pre class="java"><code>Name: 设置
PackageName: com.android.settings
ApplicationName: com.android.settings.SettingsApplication
VersionName: 14
VersionCode: 34
MinSdk: 34
TargetSdk: 34
wiki: <a href="" target="_blank"></a>
name: IntentRedirectionPlusVersion
category: IntentRedirection
detail: Intent redirection, but a plus version, also support inter-component analysis
possibility: 2
model: high
scanTime: 2025-06-10T18:26:56.691984249
engineVersion:0.1.2
</code></pre><div><div class="vulnerability-detail">data flow:</div><pre><code class="java">&lt;com.android.settings.homepage.SettingsHomepageActivity: void onCreate(android.os.Bundle)&gt;-&gt;$r5_4
pf{obj{&lt;com.android.settings.SettingsActivity: android.content.Intent getTrampolineIntent(android.content.Intent,java.lang.String)&gt;:11=&gt;android.content.Intent}(unknown)-&gt;@data}
&lt;com.android.settings.homepage.SettingsHomepageActivity: void launchDeepLinkIntentToRight()&gt;-&gt;$r4
&lt;com.android.settings.homepage.SettingsHomepageActivity: void launchDeepLinkIntentToRight()&gt;-&gt;$r5
&lt;com.android.settings.homepage.SettingsHomepageActivity: void launchDeepLinkIntentToRight()&gt;-&gt;$r3
</code></pre><div class="vulnerability-detail">call stack: </div><pre><code class="java">&lt;com.android.settings.homepage.SettingsHomepageActivity: void launchDeepLinkIntentToRight()&gt;
</code></pre><div class="vulnerability-detail">code detail: </div><div><pre><code class="java"><div class="bgheader2">&lt;com.android.settings.homepage.SettingsHomepageActivity: void onCreate(android.os.Bundle)&gt;-&gt;$r5_4</div><div class="bgheader1">pf{obj{&lt;com.android.settings.SettingsActivity: android.content.Intent getTrampolineIntent(android.content.Intent,java.lang.String)&gt;:11=&gt;android.content.Intent}(unknown)-&gt;@data}</div><div class="bgheader2">&lt;com.android.settings.homepage.SettingsHomepageActivity: void launchDeepLinkIntentToRight()&gt;-&gt;$r4</div><div class="bgheader1">&lt;com.android.settings.homepage.SettingsHomepageActivity: void launchDeepLinkIntentToRight()&gt;-&gt;$r5</div><div class="bgheader2">&lt;com.android.settings.homepage.SettingsHomepageActivity: void launchDeepLinkIntentToRight()&gt;-&gt;$r3</div></code></pre><pre><code class="java">1:  r0 := @this: com.android.settings.homepage.SettingsHomepageActivity
2:  $z0 = r0 instanceof com.android.settings.homepage.DeepLinkHomepageActivity
3: if $z0 != 0   goto LABEL1
4:  $z0_1 = r0 instanceof com.android.settings.homepage.DeepLinkHomepageActivityInternal
5: if $z0_1 != 0   goto LABEL1
6:  staticinvoke &lt;android.util.Log: int e(java.lang.String,java.lang.String)&gt;(&quot;SettingsHomepageActivity&quot;, &quot;Not a deep link component&quot;)
7:  virtualinvoke r0.&lt;android.app.Activity: void finish()&gt;()
8:  return
LABEL1:
9:  $z0_3 = staticinvoke &lt;com.google.android.setupcompat.util.WizardManagerHelper: boolean isUserSetupComplete(android.content.Context)&gt;(r0)
10: if $z0_3 != 0   goto LABEL2
11:  staticinvoke &lt;android.util.Log: int e(java.lang.String,java.lang.String)&gt;(&quot;SettingsHomepageActivity&quot;, &quot;Cancel deep link before SUW completed&quot;)
12:  virtualinvoke r0.&lt;android.app.Activity: void finish()&gt;()
13:  return
LABEL2:
14:  $r1 = virtualinvoke r0.&lt;android.app.Activity: android.content.Intent getIntent()&gt;()
15:  $r2 = virtualinvoke $r1.&lt;android.content.Intent: java.lang.String getStringExtra(java.lang.String)&gt;(&quot;android.provider.extra.SETTINGS_EMBEDDED_DEEP_LINK_INTENT_URI&quot;)
16:  $z0_4 = staticinvoke &lt;android.text.TextUtils: boolean isEmpty(java.lang.CharSequence)&gt;($r2)
17: if $z0_4 == 0   goto LABEL3
18:  staticinvoke &lt;android.util.Log: int e(java.lang.String,java.lang.String)&gt;(&quot;SettingsHomepageActivity&quot;, &quot;No EXTRA_SETTINGS_EMBEDDED_DEEP_LINK_INTENT_URI to deep link&quot;)
19:  virtualinvoke r0.&lt;android.app.Activity: void finish()&gt;()
20:  return
LABEL3:
21:  $r3 = staticinvoke &lt;android.content.Intent: android.content.Intent parseUri(java.lang.String,int)&gt;($r2, 1)
22:  $r4 = virtualinvoke $r1.&lt;android.content.Intent: android.os.Parcelable getParcelableExtra(java.lang.String)&gt;(&quot;settings_large_screen_deep_link_intent_data&quot;)
<div class="highlightcode">23:-&gt;[1] $r5 = (android.net.Uri) $r4</div><div class="highlightcode">24:-&gt;[2] virtualinvoke $r3.&lt;android.content.Intent: android.content.Intent setData(android.net.Uri)&gt;($r5)</div>25:  $r6 = virtualinvoke r0.&lt;android.app.Activity: android.content.pm.PackageManager getPackageManager()&gt;()
26:  $r7 = virtualinvoke $r3.&lt;android.content.Intent: android.content.ComponentName resolveActivity(android.content.pm.PackageManager)&gt;($r6)
27: if $r7 != null   goto LABEL4
28:  $r20 = new java.lang.StringBuilder
29:  specialinvoke $r20.&lt;java.lang.StringBuilder: void &lt;init&gt;()&gt;()
30:  virtualinvoke $r20.&lt;java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)&gt;(&quot;No valid target for the deep link intent: &quot;)
31:  virtualinvoke $r20.&lt;java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.Object)&gt;($r3)
32:  $r2_1 = virtualinvoke $r20.&lt;java.lang.StringBuilder: java.lang.String toString()&gt;()
33:  staticinvoke &lt;android.util.Log: int e(java.lang.String,java.lang.String)&gt;(&quot;SettingsHomepageActivity&quot;, $r2_1)
34:  virtualinvoke r0.&lt;android.app.Activity: void finish()&gt;()
35:  return
LABEL4:
36:  $r6_1 = virtualinvoke r0.&lt;android.app.Activity: android.content.pm.PackageManager getPackageManager()&gt;()
37:  $r8 = virtualinvoke $r6_1.&lt;android.content.pm.PackageManager: android.content.pm.ActivityInfo getActivityInfo(android.content.ComponentName,int)&gt;($r7, 0)
38:  $r9 = virtualinvoke $r1.&lt;android.content.Intent: java.lang.Object getParcelableExtra(java.lang.String,java.lang.Class)&gt;(&quot;user_handle&quot;, class &quot;Landroid/os/UserHandle;&quot;)
39:  $r10 = (android.os.UserHandle) $r9
40:  $r2_2 = virtualinvoke r0.&lt;com.android.settings.homepage.SettingsHomepageActivity: java.lang.String getInitialReferrer()&gt;()
41: if $r2_2 == null   goto LABEL5
42:  $r6_2 = virtualinvoke r0.&lt;android.app.Activity: android.content.pm.PackageManager getPackageManager()&gt;()
43:  $r11 = staticinvoke &lt;android.content.pm.PackageManager$ApplicationInfoFlags: android.content.pm.PackageManager$ApplicationInfoFlags of(long)&gt;(0L)
44: if $r10 == null   goto LABEL6
45:  $i0 = virtualinvoke $r10.&lt;android.os.UserHandle: int getIdentifier()&gt;()
46:  $i0_2 = $i0
47:  goto [?= $r12 = virtualinvoke $r6_2.&lt;android.content.pm.PackageManager: android.content.pm.ApplicationInfo getApplicationInfoAsUser(java.lang.String,android.content.pm.PackageManager$ApplicationInfoFlags,int)&gt;($r2_2, $r11, $i0_2)]
LABEL6:
48:  $i0_2 = virtualinvoke r0.&lt;android.app.Activity: int getUserId()&gt;()
49:  $r12 = virtualinvoke $r6_2.&lt;android.content.pm.PackageManager: android.content.pm.ApplicationInfo getApplicationInfoAsUser(java.lang.String,android.content.pm.PackageManager$ApplicationInfoFlags,int)&gt;($r2_2, $r11, $i0_2)
50:  $i0_6 = $r12.&lt;android.content.pm.ApplicationInfo: int uid&gt;
51:  goto [?= $r14 = $r8.&lt;android.content.pm.ActivityInfo: java.lang.String packageName&gt;]
52:  $r13 := @caughtexception
53:  $r20_1 = new java.lang.StringBuilder
54:  specialinvoke $r20_1.&lt;java.lang.StringBuilder: void &lt;init&gt;()&gt;()
55:  virtualinvoke $r20_1.&lt;java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)&gt;(&quot;Not able to get callerUid: &quot;)
56:  virtualinvoke $r20_1.&lt;java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.Object)&gt;($r13)
57:  $r2_3 = virtualinvoke $r20_1.&lt;java.lang.StringBuilder: java.lang.String toString()&gt;()
58:  staticinvoke &lt;android.util.Log: int e(java.lang.String,java.lang.String)&gt;(&quot;SettingsHomepageActivity&quot;, $r2_3)
59:  virtualinvoke r0.&lt;android.app.Activity: void finish()&gt;()
60:  return
LABEL5:
61:  $i0_6 = -1
62:  $r14 = $r8.&lt;android.content.pm.ActivityInfo: java.lang.String packageName&gt;
63:  $z0_5 = specialinvoke r0.&lt;com.android.settings.homepage.SettingsHomepageActivity: boolean hasPrivilegedAccess(java.lang.String,int,java.lang.String)&gt;($r2_2, $i0_6, $r14)
64: if $z0_5 != 0   goto LABEL7
65:  $z0_6 = $r8.&lt;android.content.pm.ActivityInfo: boolean exported&gt;
66: if $z0_6 != 0   goto LABEL8
67:  staticinvoke &lt;android.util.Log: int e(java.lang.String,java.lang.String)&gt;(&quot;SettingsHomepageActivity&quot;, &quot;Target Activity is not exported&quot;)
68:  virtualinvoke r0.&lt;android.app.Activity: void finish()&gt;()
69:  return
LABEL8:
70:  $r2_4 = $r8.&lt;android.content.pm.ActivityInfo: java.lang.String permission&gt;
71:  $z0_7 = virtualinvoke r0.&lt;com.android.settings.homepage.SettingsHomepageActivity: boolean isCallingAppPermitted(java.lang.String,int)&gt;($r2_4, $i0_6)
72: if $z0_7 != 0   goto LABEL7
73:  staticinvoke &lt;android.util.Log: int e(java.lang.String,java.lang.String)&gt;(&quot;SettingsHomepageActivity&quot;, &quot;Calling app must have the permission of deep link Activity&quot;)
74:  virtualinvoke r0.&lt;android.app.Activity: void finish()&gt;()
75:  return
LABEL7:
76:  $i1 = virtualinvoke $r3.&lt;android.content.Intent: int getFlags()&gt;()
77:  $i1_1 = $i1 &amp; 3
78:  $r5_1 = virtualinvoke $r3.&lt;android.content.Intent: android.net.Uri getData()&gt;()
79: if $r5_1 == null   goto LABEL9
80: if $i1_1 == 0   goto LABEL9
81:  $r5_2 = virtualinvoke $r3.&lt;android.content.Intent: android.net.Uri getData()&gt;()
82:  $i0_7 = virtualinvoke r0.&lt;android.app.Activity: int checkUriPermission(android.net.Uri,int,int,int)&gt;($r5_2, -1, $i0_6, $i1_1)
83: if $i0_7 != -1   goto LABEL9
84:  staticinvoke &lt;android.util.Log: int e(java.lang.String,java.lang.String)&gt;(&quot;SettingsHomepageActivity&quot;, &quot;Calling app must have the permission to access Uri and grant permission&quot;)
85:  virtualinvoke r0.&lt;android.app.Activity: void finish()&gt;()
86:  return
LABEL9:
87:  virtualinvoke $r3.&lt;android.content.Intent: android.content.Intent setComponent(android.content.ComponentName)&gt;($r7)
88:  virtualinvoke $r1.&lt;android.content.Intent: android.content.Intent setAction(java.lang.String)&gt;(null)
89:  virtualinvoke $r3.&lt;android.content.Intent: void removeFlags(int)&gt;(268959744)
90:  virtualinvoke $r3.&lt;android.content.Intent: android.content.Intent addFlags(int)&gt;(33554432)
91:  virtualinvoke $r3.&lt;android.content.Intent: android.content.Intent replaceExtras(android.content.Intent)&gt;($r1)
92:  virtualinvoke $r3.&lt;android.content.Intent: android.content.Intent putExtra(java.lang.String,boolean)&gt;(&quot;is_from_settings_homepage&quot;, 1)
93:  virtualinvoke $r3.&lt;android.content.Intent: android.content.Intent putExtra(java.lang.String,boolean)&gt;(&quot;is_from_slice&quot;, 0)
94:  $r21 = new android.content.ComponentName
95:  $r15 = virtualinvoke r0.&lt;android.app.Activity: android.content.Context getApplicationContext()&gt;()
96:  $r16 = virtualinvoke r0.&lt;java.lang.Object: java.lang.Class getClass()&gt;()
97:  specialinvoke $r21.&lt;android.content.ComponentName: void &lt;init&gt;(android.content.Context,java.lang.Class)&gt;($r15, $r16)
98:  $r2_6 = virtualinvoke $r3.&lt;android.content.Intent: java.lang.String getAction()&gt;()
99:  $r17 = &lt;androidx.window.embedding.SplitRule$FinishBehavior: androidx.window.embedding.SplitRule$FinishBehavior ALWAYS&gt;
100:  staticinvoke &lt;com.android.settings.activityembedding.ActivityEmbeddingRulesController: void registerTwoPanePairRule(android.content.Context,android.content.ComponentName,android.content.ComponentName,java.lang.String,androidx.window.embedding.SplitRule$FinishBehavior,androidx.window.embedding.SplitRule$FinishBehavior,boolean)&gt;(r0, $r21, $r7, $r2_6, $r17, $r17, 1)
101:  $r21_1 = new android.content.ComponentName
102:  $r15_1 = virtualinvoke r0.&lt;android.app.Activity: android.content.Context getApplicationContext()&gt;()
103:  specialinvoke $r21_1.&lt;android.content.ComponentName: void &lt;init&gt;(android.content.Context,java.lang.Class)&gt;($r15_1, class &quot;Lcom/android/settings/Settings;&quot;)
104:  $r2_7 = virtualinvoke $r3.&lt;android.content.Intent: java.lang.String getAction()&gt;()
105:  staticinvoke &lt;com.android.settings.activityembedding.ActivityEmbeddingRulesController: void registerTwoPanePairRule(android.content.Context,android.content.ComponentName,android.content.ComponentName,java.lang.String,androidx.window.embedding.SplitRule$FinishBehavior,androidx.window.embedding.SplitRule$FinishBehavior,boolean)&gt;(r0, $r21_1, $r7, $r2_7, $r17, $r17, 1)
106: if $r10 == null   goto LABEL10
<div class="highlightcode">107:-&gt;[Sink] virtualinvoke r0.&lt;android.app.Activity: void startActivityAsUser(android.content.Intent,android.os.UserHandle)&gt;($r3, $r10)</div>108:  return
LABEL10:<div class="highlightcode">109:-&gt;[Sink] virtualinvoke r0.&lt;android.app.Activity: void startActivity(android.content.Intent)&gt;($r3)</div>110:  return
111:  $r18 := @caughtexception
112:  $r20_2 = new java.lang.StringBuilder
113:  specialinvoke $r20_2.&lt;java.lang.StringBuilder: void &lt;init&gt;()&gt;()
</code></pre></div></div></body></html>